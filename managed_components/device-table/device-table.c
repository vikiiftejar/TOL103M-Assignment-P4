#include "device-table.h"

#include <stddef.h>

static const lownet_identifier_t device_table[] =
{
	// Reserved -- dead identifier.
	{{0x00,0x00,0x00,0x00,0x00,0x00}, 0},

	{{0xf0,0x24,0xf9,0x0c,0xd6,0x0c}, 0x95},
	{{0xf0,0x24,0xf9,0x0d,0xff,0xac}, 0x96},
	{{0xf0,0x24,0xf9,0x0c,0xd6,0xdc}, 0x97},
	{{0xf0,0x24,0xf9,0x0e,0x4c,0x44}, 0x98},
	{{0xf0,0x24,0xf9,0x0e,0x42,0xd0}, 0x99},
	{{0xf0,0x24,0xf9,0x0e,0x01,0xe8}, 0x9a},
	{{0xf0,0x24,0xf9,0x0d,0x61,0x0c}, 0x9b},
	{{0xf0,0x24,0xf9,0x0c,0xd5,0x40}, 0x9c},
	{{0xf0,0x24,0xf9,0x0e,0x41,0x08}, 0x9d},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x0c}, 0x9e},
	{{0xf0,0x24,0xf9,0x0d,0xfd,0xa8}, 0x9f},
	{{0xf0,0x24,0xf9,0x0e,0x4b,0xb4}, 0xa0},
	{{0xf0,0x24,0xf9,0x0d,0xfb,0xbc}, 0xa1},
	{{0x00,0x4b,0x12,0x9b,0x88,0x30}, 0xa2},
	{{0xf0,0x24,0xf9,0x0e,0x94,0xf8}, 0xa3},
	{{0xf0,0x24,0xf9,0x0e,0x43,0x48}, 0xa4},
	{{0x00,0x4b,0x12,0x9b,0x84,0x40}, 0xa5},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x10}, 0xa6},
	{{0x28,0x56,0x2f,0x4a,0x60,0xb8}, 0xa7},
	{{0x28,0x56,0x2f,0x77,0x9a,0xd0}, 0xa8},
	{{0xf0,0x24,0xf9,0x0d,0xdb,0x68}, 0xa9},
	{{0x00,0x4b,0x12,0x9b,0x4b,0xf4}, 0xaa},
	{{0xf0,0x24,0xf9,0x0e,0x00,0xb0}, 0xab},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0x7c}, 0xac},
	{{0x28,0x56,0x2f,0x4b,0x45,0x7c}, 0xad},
	{{0xf0,0x24,0xf9,0x0e,0x07,0x08}, 0xae},
	{{0x28,0x56,0x2f,0x4a,0x09,0x24}, 0xaf},
	{{0xf0,0x24,0xf9,0x0c,0xd5,0xfc}, 0xb0},
	{{0x28,0x56,0x2f,0x4a,0xd6,0x64}, 0xb1},
	{{0x28,0x56,0x2f,0x4a,0x18,0x14}, 0xb2},
	{{0x28,0x56,0x2f,0x4b,0x49,0x98}, 0xb3},
	{{0xf0,0x24,0xf9,0x0e,0x49,0x30}, 0xb4},
	{{0xf0,0x24,0xf9,0x0e,0x0d,0x1c}, 0xb5},
	{{0xf0,0x24,0xf9,0x0c,0xd4,0xb8}, 0xb6},
	{{0xf0,0x24,0xf9,0x0e,0xbc,0x90}, 0xb7},
	{{0xf0,0x24,0xf9,0x0e,0xc5,0x60}, 0xb8},
	{{0xf0,0x24,0xf9,0x0e,0x43,0xf0}, 0xb9},
	{{0xf0,0x24,0xf9,0x0d,0x60,0x1c}, 0xba},
	{{0xf0,0x24,0xf9,0x0e,0x95,0x50}, 0xbb},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0xf8}, 0xbc},
	{{0xf0,0x24,0xf9,0x0e,0x9d,0x38}, 0xbd},
	{{0xf0,0x24,0xf9,0x0e,0x72,0xac}, 0xbe},
	{{0xf0,0x24,0xf9,0x0e,0x07,0x18}, 0xbf},
	{{0xf0,0x24,0xf9,0x0d,0xf7,0x8c}, 0xc0},
	{{0xf0,0x24,0xf9,0x0d,0x0d,0x6c}, 0xc1},
	{{0xf0,0x24,0xf9,0x0c,0xc3,0xf4}, 0xc2},
	{{0x48,0xe7,0x29,0x98,0xe9,0x30}, 0xc3},
	{{0xf0,0x24,0xf9,0x0e,0x49,0xa0}, 0xc4},
	{{0x48,0xe7,0x29,0x99,0x22,0x14}, 0xc5},
	{{0xf0,0x24,0xf9,0x0e,0x10,0x54}, 0xc6},

	// Master node
	{{0xb0,0xa7,0x32,0xdb,0x44,0xac}, 0xF0},

	{{0x48,0xe7,0x29,0x99,0x4d,0x20}, 0xEE}, // Crane

	// Gr√≥ska teaching node
	{{0x24,0x0a,0xc4,0x60,0xa5,0xfc}, 0xEF},

	// Kjartan
	{{0xf0,0x24,0xf9,0x0c,0xcc,0xfc}, 0xFE},

	// Broadcast identifier.
	{{0xFF,0xFF,0xFF,0xFF,0xFF,0xFF}, 0xFF}
};

// Lookup identifier by node id.
lownet_identifier_t lownet_lookup(uint8_t id) {
	size_t size = sizeof(device_table) / sizeof(device_table[0]);
	for (int i = 0; i < size; ++i) {
		if (device_table[i].node == id) {
			return device_table[i];
		}
	}
	return device_table[0];
}

// Lookup identifier by mac address.
lownet_identifier_t lownet_lookup_mac(const uint8_t* mac) {
	size_t size = sizeof(device_table) / sizeof(device_table[0]);
	for (int i = 0; i < size; ++i) {
		int match = 1;
		for (int j = 0; j < 6; ++j) {
			if (device_table[i].mac[j] != mac[j]) {
				match = 0;
			}
		}
		if (match) {
			return device_table[i];
		}
	}
	return device_table[0];
}
